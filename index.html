<!DOCTYPE html>
<html lang="bn">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>‡¶∂‡¶¨‡ßç‡¶¶ ‡¶ï‡ßÅ‡¶á‡¶ú + ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶°‡¶Æ‡¶ø‡¶®</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<style>
body { font-family: "Noto Sans Bengali", sans-serif; background: #f8f9fa; }
.quiz-card { max-width: 500px; margin: 30px auto; padding: 25px 20px; border-radius: 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); }
.word { font-size: 36px; font-weight: bold; margin-bottom: 10px; }
.result { margin-top: 10px; font-size: 18px; font-weight: 600; }
.btn-group-mcq { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 15px; }
.btn-group-mcq .btn { width: 100%; min-height: 60px; font-size: 18px; }
.admin-panel { display:none; margin-top:40px; }
.table td, .table th { vertical-align: middle; }
.jsonBox { display:none; margin-top:20px; }
textarea { font-family: monospace; }
.correct { border: 2px solid green !important; }
.wrong { border: 2px solid red !important; }
</style>
</head>
<body>

<div class="container">

  <!-- Toggle Buttons -->
  <div class="text-end mt-3">
    <button id="quizBtn" class="btn btn-primary" onclick="showQuiz()">üéÆ ‡¶ï‡ßÅ‡¶á‡¶ú</button>
    <button id="adminBtn" class="btn btn-dark" onclick="showAdmin()">‚öôÔ∏è ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶°‡¶Æ‡¶ø‡¶®</button>
  </div>

  <!-- Quiz Section -->
  <div id="quizSection">
    <div class="card quiz-card text-center">
      <div class="card-body">
        <div id="word" class="word">‡¶≤‡ßã‡¶° ‡¶π‡¶ö‡ßç‡¶õ‡ßá...</div>

        <div class="btn-group-mcq">
          <button class="btn btn-primary" onclick="checkAnswer(this)">A</button>
          <button class="btn btn-success" onclick="checkAnswer(this)">B</button>
          <button class="btn btn-warning" onclick="checkAnswer(this)">C</button>
          <button class="btn btn-danger" onclick="checkAnswer(this)">D</button>
        </div>

        <div class="result" id="result"></div>
        <button class="btn btn-secondary mt-3" onclick="nextWord()">‡¶™‡¶∞‡ßá‡¶∞ ‡¶∂‡¶¨‡ßç‡¶¶</button>
      </div>
    </div>
  </div>

  <!-- Admin Panel -->
  <div id="adminPanel" class="admin-panel">
    <h2 class="mb-4">üß© ‡¶∂‡¶¨‡ßç‡¶¶‡ßá‡¶∞ ‡¶°‡ßá‡¶ü‡¶æ‡¶¨‡ßá‡¶ú</h2>

    <button class="btn btn-info mb-3" onclick="toggleJson('words')">üìÑ Words JSON</button>
    <button class="btn btn-info mb-3" onclick="toggleJson('origin')">üìÑ Origin Words JSON</button>

    <div id="jsonBoxWords" class="jsonBox">
      <label class="fw-bold mt-3">Words JSON (copy only):</label>
      <textarea id="jsonViewWords" class="form-control" rows="10" readonly></textarea>
    </div>
    <div id="jsonBoxOrigin" class="jsonBox">
      <label class="fw-bold mt-3">Origin Words JSON (copy only):</label>
      <textarea id="jsonViewOrigin" class="form-control" rows="10" readonly></textarea>
    </div>
  </div>

</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
<script>
let words = [];
let originWords = [];
let allWords = [];
let currentWordIndex = -1;
let answered = false;

const originOptions = ["‡¶ö‡¶ø‡¶®‡¶æ","‡¶¨‡¶æ‡¶∞‡ßç‡¶Æ‡¶ø‡¶ú","‡¶π‡¶ø‡¶®‡ßç‡¶¶‡¶ø","‡¶á‡¶Ç‡¶∞‡ßá‡¶ú‡¶ø","‡¶Ü‡¶∞‡¶¨‡¶ø","‡¶´‡¶æ‡¶∞‡¶∏‡¶ø","‡¶™‡¶∞‡ßç‡¶§‡ßÅ‡¶ó‡¶ø‡¶ú","‡¶´‡¶∞‡¶æ‡¶∏‡¶ø","‡¶§‡ßÅ‡¶∞‡ßç‡¶ï‡¶ø"];

async function loadData() {
  const wordsResp = await fetch('DB1.json');
  words = await wordsResp.json();

  const originResp = await fetch('DB2.json');
  originWords = await originResp.json();

  resetAllWords();
  nextWord();
}

function shuffleArray(array) {
  for (let i = array.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [array[i], array[j]] = [array[j], array[i]];
  }
  return array;
}

function resetAllWords(){
  allWords = [...words, ...originWords];
  shuffleArray(allWords);
  currentWordIndex = -1;
}

function nextWord() {
  answered = false;
  currentWordIndex++;
  if (currentWordIndex >= allWords.length) {
    alert("‡¶∏‡¶¨ ‡¶∂‡¶¨‡ßç‡¶¶ ‡¶∂‡ßá‡¶∑!");
    return;
  }

  const currentWord = allWords[currentWordIndex];
  document.getElementById("word").innerText = currentWord.text || "";
  const resultEl = document.getElementById("result");
  resultEl.innerText = "";
  resultEl.style.color = "";

  const btns = document.querySelectorAll(".btn-group-mcq .btn");
  btns.forEach(b => {
    b.disabled = false;
    delete b.dataset.type;
    b.classList.remove("correct", "wrong");
  });

  let options = [];
  let correctIndex = Math.floor(Math.random() * 4);

  if (currentWord.hasOwnProperty('language') && currentWord.language) {
    const other = originOptions.filter(l => l !== currentWord.language);
    options = shuffleArray(other).slice(0, 3);
    options.splice(correctIndex, 0, currentWord.language);
  } else {
    const types = ["‡¶§‡ßé‡¶∏‡¶Æ", "‡¶§‡¶¶‡ßç‡¶≠‡¶¨", "‡¶Ö‡¶∞‡ßç‡¶ß-‡¶§‡ßé‡¶∏‡¶Æ", "‡¶¶‡ßá‡¶∂‡¶ø"];
    const other = types.filter(t => t !== currentWord.type);
    options = shuffleArray(other).slice(0, 3);
    options.splice(correctIndex, 0, currentWord.type);
  }

  btns.forEach((btn, i) => {
    btn.dataset.type = options[i];
    btn.innerText = String.fromCharCode(65 + i) + ". " + options[i];
  });
}

function checkAnswer(btnElement) {
  const result = document.getElementById("result");
  const currentWord = allWords[currentWordIndex];

  if (!currentWord) {
    result.textContent = "‡¶ï‡ßã‡¶®‡ßã ‡¶∂‡¶¨‡ßç‡¶¶ ‡¶™‡¶æ‡¶ì‡ßü‡¶æ ‡¶Ø‡¶æ‡ßü‡¶®‡¶ø‡•§";
    return;
  }

  if (answered) {
    result.innerText = "‚ö†Ô∏è ‡¶è‡¶ï‡¶æ‡¶ß‡¶ø‡¶ï ‡¶â‡¶§‡ßç‡¶§‡¶∞ ‡¶ó‡ßç‡¶∞‡¶π‡¶£‡¶Ø‡ßã‡¶ó‡ßç‡¶Ø ‡¶®‡ßü";
    result.style.color = "orange";
    return;
  }

  const selectedType = (btnElement.dataset.type || "").trim();
  const correctAnswer = ((currentWord.type && currentWord.type.trim()) ||
                         (currentWord.language && currentWord.language.trim()) || "").trim();

  answered = true;

  if (selectedType === correctAnswer) {
    result.innerHTML = `‚úÖ <span style="color:green">‡¶∏‡¶†‡¶ø‡¶ï: ${correctAnswer}</span>`;
    btnElement.classList.add("correct");
  } else {
    result.innerHTML = `‚ùå ‡¶≠‡ßÅ‡¶≤! <span style="color:green">‡¶∏‡¶†‡¶ø‡¶ï: ${correctAnswer}</span>`;
    btnElement.classList.add("wrong");
  }

  document.querySelectorAll(".btn-group-mcq .btn").forEach(b => b.disabled = true);
}

function toggleJson(type){
  if(type==='words'){
    const box = document.getElementById("jsonBoxWords");
    box.style.display = box.style.display==='none'?'block':'none';
    document.getElementById("jsonViewWords").value = JSON.stringify(words, null, 2);
  } else {
    const box = document.getElementById("jsonBoxOrigin");
    box.style.display = box.style.display==='none'?'block':'none';
    document.getElementById("jsonViewOrigin").value = JSON.stringify(originWords, null, 2);
  }
}

function showQuiz(){
  document.getElementById("quizSection").style.display="block";
  document.getElementById("adminPanel").style.display="none";
}

function showAdmin(){
  document.getElementById("quizSection").style.display="none";
  document.getElementById("adminPanel").style.display="block";
}

// --- init ---
window.onload = loadData;
</script>
</body>
</html>
