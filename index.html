<!DOCTYPE html>
<html lang="bn">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>শব্দ </title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<style>
body { font-family: "Noto Sans Bengali", sans-serif; background: #f8f9fa; }
.quiz-card { max-width: 500px; margin: 30px auto; padding: 25px 20px; border-radius: 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); }
.word { font-size: 36px; font-weight: bold; margin-bottom: 10px; }
.result { margin-top: 10px; font-size: 18px; font-weight: 600; }
.btn-group-mcq { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 15px; }
.btn-group-mcq .btn { width: 100%; min-height: 60px; font-size: 18px; }
</style>
</head>
<body>
<div class="container">
  <div class="d-flex justify-content-end my-3">
    <a href="admin.html" class="btn btn-warning">Admin Panel</a>
  </div>

  <div id="quizCard" class="card quiz-card text-center">
    <div class="card-body">
      <div id="word" class="word">লোড হচ্ছে...</div>
      <div class="btn-group-mcq">
        <button class="btn btn-primary" onclick="checkAnswer(this)">A</button>
        <button class="btn btn-success" onclick="checkAnswer(this)">B</button>
        <button class="btn btn-warning" onclick="checkAnswer(this)">C</button>
        <button class="btn btn-danger" onclick="checkAnswer(this)">D</button>
      </div>
      <div class="result" id="result"></div>
      <button class="btn btn-secondary mt-3" onclick="nextWord()">পরের শব্দ</button>
    </div>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
<script>
// ---------------- localStorage থেকে ডেটা লোড -----------------
let quizData = JSON.parse(localStorage.getItem("quizData"));
let allWords = [];
const originOptions = ["চিনা","বার্মা","হিন্দি","ইংরেজি","আরবি","তুর্কি","ওলন্দাজ","পাঞ্জাবি"];

let currentWordIndex = -1;
let answered = false;

// ---------------- Utility: Shuffle -----------------
function shuffleArray(array) {
  for (let i = array.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [array[i], array[j]] = [array[j], array[i]];
  }
  return array;
}

// ---------------- Load Next Word -----------------
function nextWord() {
  if(!quizData){
    document.getElementById("word").innerText = "⚠️ এখনো কোনো ডেটা নেই! আগে Admin Panel থেকে শব্দ যোগ করুন।";
    return;
  }

  answered = false;
  if(allWords.length === 0){
    allWords = [...quizData.words, ...quizData.originWords];
    shuffleArray(allWords);
  }

  currentWordIndex++;
  if(currentWordIndex >= allWords.length){
    alert("সব শব্দ শেষ!");
    return;
  }

  const currentWord = allWords[currentWordIndex];
  document.getElementById("word").innerText = currentWord.text;
  document.getElementById("result").innerText = "";

  const btns = document.querySelectorAll(".btn-group-mcq .btn");
  btns.forEach(b => b.disabled = false);

  let options = [];
  const correctIndex = Math.floor(Math.random()*4);

  if(currentWord.language){
    // Origin word
    options = originOptions.filter(l => l !== currentWord.language);
    options = shuffleArray(options).slice(0,3);
    options.splice(correctIndex, 0, currentWord.language);
  } else {
    // Normal word
    const types = ["তৎসম","তদ্ভব","অর্ধ-তৎসম","দেশি","বিদেশি"];
    options = types.filter(t => t !== currentWord.type);
    options = shuffleArray(options).slice(0,3);
    options.splice(correctIndex, 0, currentWord.type);
  }

  btns.forEach((btn,index)=>{
    btn.dataset.type = options[index];
    btn.innerText = String.fromCharCode(65+index) + ". " + options[index];
  });
}

// ---------------- Check Answer -----------------
function checkAnswer(btn) {
  if(answered){
    document.getElementById("result").innerText = "⚠️ একাধিক উত্তর গ্রহণযোগ্য নয়";
    document.getElementById("result").style.color = "orange";
    return;
  }

  answered = true;
  btn.disabled = true;
  const currentWord = allWords[currentWordIndex];
  const selectedType = btn.dataset.type;
  const correctAnswer = currentWord.type || currentWord.language;

  if(selectedType === correctAnswer){
    document.getElementById("result").innerHTML = `✅ <span style="color:green">সঠিক: ${correctAnswer}</span>`;
  } else {
    document.getElementById("result").innerHTML = `❌ ভুল! <span style="color:green">সঠিক: ${correctAnswer}</span>`;
  }
}

// ---------------- On Load -----------------
nextWord();
</script>
</body>
</html>
